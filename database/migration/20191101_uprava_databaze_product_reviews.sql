--pridani novych sloupcu
ALTER TABLE features_text ADD COLUMN features_id integer; 
ALTER TABLE features_text ADD COLUMN description character varying(4000);


--nahrani hodnot features_id do tabulky features_text
UPDATE features_text SET features_id=9 WHERE id=12;
UPDATE features_text SET features_id=16 WHERE id=59;
UPDATE features_text SET features_id=29 WHERE id=60;
UPDATE features_text SET features_id=15 WHERE id=66;
UPDATE features_text SET features_id=9 WHERE id=50;
UPDATE features_text SET features_id=45 WHERE id=67;
UPDATE features_text SET features_id=36 WHERE id=68;
UPDATE features_text SET features_id=42 WHERE id=69;
UPDATE features_text SET features_id=5 WHERE id=70;
UPDATE features_text SET features_id=26 WHERE id=73;
UPDATE features_text SET features_id=7 WHERE id=74;
UPDATE features_text SET features_id=3 WHERE id=75;
UPDATE features_text SET features_id=41 WHERE id=76;
UPDATE features_text SET features_id=19 WHERE id=77;
UPDATE features_text SET features_id=51 WHERE id=78;
UPDATE features_text SET features_id=23 WHERE id=80;
UPDATE features_text SET features_id=36 WHERE id=81;
UPDATE features_text SET features_id=9 WHERE id=82;
UPDATE features_text SET features_id=49 WHERE id=83;
UPDATE features_text SET features_id=56 WHERE id=84;
UPDATE features_text SET features_id=11 WHERE id=85;
UPDATE features_text SET features_id=54 WHERE id=86;
UPDATE features_text SET features_id=8 WHERE id=87;
UPDATE features_text SET features_id=22 WHERE id=90;
UPDATE features_text SET features_id=27 WHERE id=88;
UPDATE features_text SET features_id=30 WHERE id=91;
UPDATE features_text SET features_id=32 WHERE id=92;
UPDATE features_text SET features_id=45 WHERE id=93;
UPDATE features_text SET features_id=40 WHERE id=94;
UPDATE features_text SET features_id=35 WHERE id=95;
UPDATE features_text SET features_id=25 WHERE id=96;
UPDATE features_text SET features_id=13 WHERE id=97;
UPDATE features_text SET features_id=44 WHERE id=98;
UPDATE features_text SET features_id=34 WHERE id=99;
UPDATE features_text SET features_id=20 WHERE id=100;
UPDATE features_text SET features_id=52 WHERE id=101;
UPDATE features_text SET features_id=46 WHERE id=102;
UPDATE features_text SET features_id=53 WHERE id=103;
UPDATE features_text SET features_id=7 WHERE id=104;
UPDATE features_text SET features_id=29 WHERE id=106;
UPDATE features_text SET features_id=33 WHERE id=107;
UPDATE features_text SET features_id=10 WHERE id=108;
UPDATE features_text SET features_id=15 WHERE id=109;
UPDATE features_text SET features_id=37 WHERE id=110;
UPDATE features_text SET features_id=43 WHERE id=111;
UPDATE features_text SET features_id=32 WHERE id=25;
UPDATE features_text SET features_id=45 WHERE id=26;
UPDATE features_text SET features_id=40 WHERE id=27;
UPDATE features_text SET features_id=17 WHERE id=29;
UPDATE features_text SET features_id=44 WHERE id=31;
UPDATE features_text SET features_id=34 WHERE id=32;
UPDATE features_text SET features_id=20 WHERE id=33;
UPDATE features_text SET features_id=52 WHERE id=34;
UPDATE features_text SET features_id=46 WHERE id=35;
UPDATE features_text SET features_id=53 WHERE id=36;
UPDATE features_text SET features_id=7 WHERE id=37;
UPDATE features_text SET features_id=27 WHERE id=38;
UPDATE features_text SET features_id=29 WHERE id=39;
UPDATE features_text SET features_id=33 WHERE id=40;
UPDATE features_text SET features_id=37 WHERE id=44;
UPDATE features_text SET features_id=43 WHERE id=45;
UPDATE features_text SET features_id=55 WHERE id=46;
UPDATE features_text SET features_id=22 WHERE id=47;
UPDATE features_text SET features_id=4 WHERE id=48;
UPDATE features_text SET features_id=50 WHERE id=49;
UPDATE features_text SET features_id=57 WHERE id=51;
UPDATE features_text SET features_id=24 WHERE id=52;
UPDATE features_text SET features_id=21 WHERE id=53;
UPDATE features_text SET features_id=12 WHERE id=54;
UPDATE features_text SET features_id=10 WHERE id=41;
UPDATE features_text SET features_id=22 WHERE id=113;
UPDATE features_text SET features_id=4 WHERE id=114;
UPDATE features_text SET features_id=50 WHERE id=115;
UPDATE features_text SET features_id=9 WHERE id=116;
UPDATE features_text SET features_id=57 WHERE id=117;
UPDATE features_text SET features_id=35 WHERE id=28;
UPDATE features_text SET features_id=31 WHERE id=57;
UPDATE features_text SET features_id=28 WHERE id=19;
UPDATE features_text SET features_id=6 WHERE id=0;
UPDATE features_text SET features_id=8 WHERE id=17;
UPDATE features_text SET features_id=54 WHERE id=16;
UPDATE features_text SET features_id=7 WHERE id=2;
UPDATE features_text SET features_id=30 WHERE id=24;
UPDATE features_text SET features_id=22 WHERE id=21;
UPDATE features_text SET features_id=3 WHERE id=3;
UPDATE features_text SET features_id=23 WHERE id=10;
UPDATE features_text SET features_id=56 WHERE id=14;
UPDATE features_text SET features_id=49 WHERE id=13;
UPDATE features_text SET features_id=11 WHERE id=15;
UPDATE features_text SET features_id=51 WHERE id=7;
UPDATE features_text SET features_id=36 WHERE id=11;
UPDATE features_text SET features_id=41 WHERE id=4;
UPDATE features_text SET features_id=39 WHERE id=20;
UPDATE features_text SET features_id=48 WHERE id=58;
UPDATE features_text SET features_id=24 WHERE id=118;
UPDATE features_text SET features_id=21 WHERE id=119;
UPDATE features_text SET features_id=12 WHERE id=120;
UPDATE features_text SET features_id=2 WHERE id=121;
UPDATE features_text SET features_id=48 WHERE id=123;
UPDATE features_text SET features_id=16 WHERE id=124;
UPDATE features_text SET features_id=29 WHERE id=125;
UPDATE features_text SET features_id=1 WHERE id=127;
UPDATE features_text SET features_id=38 WHERE id=128;
UPDATE features_text SET features_id=7 WHERE id=129;
UPDATE features_text SET features_id=14 WHERE id=131;
UPDATE features_text SET features_id=31 WHERE id=122;
UPDATE features_text SET features_id=6 WHERE id=72;
UPDATE features_text SET features_id=39 WHERE id=89;
UPDATE features_text SET features_id=18 WHERE id=79;
UPDATE features_text SET features_id=25 WHERE id=130;
UPDATE features_text SET features_id=36 WHERE id=133;
UPDATE features_text SET features_id=42 WHERE id=134;
UPDATE features_text SET features_id=5 WHERE id=135;
UPDATE features_text SET features_id=27 WHERE id=105;
UPDATE features_text SET features_id=13 WHERE id=30;
UPDATE features_text SET features_id=18 WHERE id=42;
UPDATE features_text SET features_id=2 WHERE id=55;
UPDATE features_text SET features_id=19 WHERE id=5;
UPDATE features_text SET features_id=26 WHERE id=1;
UPDATE features_text SET features_id=14 WHERE id=9;
UPDATE features_text SET features_id=47 WHERE id=126;
UPDATE features_text SET features_id=45 WHERE id=132;
UPDATE features_text SET features_id=55 WHERE id=112;
UPDATE features_text SET features_id=47 WHERE id=61;
UPDATE features_text SET features_id=1 WHERE id=62;
UPDATE features_text SET features_id=38 WHERE id=63;
UPDATE features_text SET features_id=7 WHERE id=64;
UPDATE features_text SET features_id=25 WHERE id=65;

--prejmenovani tabulky features_text na features_names
ALTER TABLE features_text RENAME TO feature_names;

--prejmenovani sloupce id na feature_names_id v tabulce feature_names
ALTER TABLE feature_names RENAME COLUMN id TO feature_names_id;

--prejmenovani sloupce features_text_id na feature_names_id v tabulce reviews
ALTER TABLE reviews RENAME COLUMN features_text_id TO feature_names_id;

--uprava pohledu features 
DROP VIEW features;
CREATE VIEW features AS (SELECT reviews.products_id,
    feature_names.features_id,
    reviews.sentiment,
    (count(reviews.feature_names_id))::integer AS quantity
   FROM reviews
     JOIN feature_names USING (feature_names_id)
  GROUP BY reviews.products_id, reviews.sentiment, feature_names.features_id);

-- doplneni sloupcu unit a czech_name do tabulky characteristics
ALTER TABLE characteristics ADD COLUMN czech_name character varying(200);
ALTER TABLE characteristics ADD COLUMN unit character varying(20);  

-- --doplneni ceskych nazvu
UPDATE characteristics SET czech_name= (SELECT name FROM characteristics_names WHERE characteristics_names.id=characteristics.id AND language_id=1);

-- -- doplneni sloupcu czech_name do tabulky product_categories
ALTER TABLE product_categories ADD COLUMN czech_name character varying(100);

-- --doplneni ceskych nazvu
UPDATE product_categories SET czech_name= (SELECT name FROM product_category_names WHERE product_category_names.id=product_categories.id AND languages_id=1);

--prejmenovani sloupce id na characteristics_id v tabulce characteristics
ALTER TABLE characteristics RENAME COLUMN id TO characteristics_id;

--prejmenovani sloupce id na characteristics_id v tabulce characteristics_names
ALTER TABLE characteristics_names RENAME COLUMN id TO characteristics_id;

--prejmenovani sloupce language_id na languages_id v tabulce characteristics_names
ALTER TABLE characteristics_names RENAME COLUMN language_id TO languages_id;

--prejmenovani sloupce id na languages_id v tabulce languages
ALTER TABLE languages RENAME COLUMN id TO languages_id;

--prejmenovani sloupce id na mta_score_id v tabulce mta_score
ALTER TABLE mta_score RENAME COLUMN id TO mta_score_id;

--prejmenovani sloupce id na product_categories_id v tabulce product_categories
ALTER TABLE product_categories RENAME COLUMN id TO product_categories_id;

--prejmenovani sloupce id na product_categories_id v tabulce product_category_names
ALTER TABLE product_category_names RENAME COLUMN id TO product_categories_id;

--prejmenovani sloupce id na products_id v tabulce products
ALTER TABLE products RENAME COLUMN id TO products_id;

--prejmenovani sloupce id na product_names_id v tabulce product_names
ALTER TABLE product_names RENAME COLUMN id TO product_names_id;

--prejmenovani sloupce id na product_visits_id v tabulce product_visits
ALTER TABLE product_visits RENAME COLUMN id TO product_visits_id;

--prejmenovani sloupce id na reviews_id v tabulce reviews
ALTER TABLE reviews RENAME COLUMN id TO reviews_id;

--prejmenovani sloupce id na reviews_analysis_id v tabulce reviews_analysis
ALTER TABLE reviews_analysis RENAME COLUMN id TO reviews_analysis_id;

--prejmenovani sloupce id na user_reviews_id v tabulce user_reviews
ALTER TABLE user_reviews RENAME COLUMN id TO user_reviews_id;

--prejmenovani sloupce id na user_review_texts_id v tabulce user_review_texts
ALTER TABLE user_review_texts RENAME COLUMN id TO user_review_texts_id;

--prejmenovani sloupce id na users_id v tabulce users
ALTER TABLE users RENAME COLUMN id TO users_id;

--prejmenovani sloupce features_text_id na feature_names_id v tabulce reviews_analysis
ALTER TABLE reviews_analysis RENAME COLUMN features_text_id TO feature_names_id;